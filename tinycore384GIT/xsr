#!/bin/sh
read_options(){
	local choice
	read -p "Enter choice [ 1 - 3] " choice
	case $choice in
		1) XSRmenu ;;
		2) RDPmenu ;;
		3) exit 0;;
		*) echo -e "${RED}Error...${STD}" && sleep 2
	esac
}

Conmenu() {
	clear
	echo "~~~~~~~~~~~~~~~~~~~~~"	
	echo " M A I N - M E N U"
	echo "~~~~~~~~~~~~~~~~~~~~~"
	echo "1. X Connection (The linux Server must have installed Telnet Server and the Lxpanel)"
	echo "2. RDP Connection"
	echo "3. Exit"



#############################################################################


}
XSRmenu() {
count=0
while [ "$count" -lt 60 ]; 
do
aterm -g 50x50+10+10 -e sh -c 'read -p "Input Telnet Username=" USER;read -p "Input Telnet Password=" PASS;(echo " Welcome Please Wait...";echo -e "\r";sleep 10;echo $USER;echo -e "\r";sleep 3;echo $PASS; echo -e "\r";sleep 3;echo "ls";echo -e "\r";sleep 13;echo "export DISPLAY=$getLocIP:0";echo -e "\r";sleep 3;echo "lxpanel";echo -e "\r";sleep 555)|telnet $getSerIP'     
sleep 1
count=$((count + 1))
done
}
RDPmenu() {
count=0
while [ "$count" -lt 60 ]; 
do
aterm -g 50x50+10+10 -e sh -c 'echo $getSerIP;read -p "Input RDP SERVER Username=" USER;read -p "Input RDP SERVER Password=" PASS;rdesktop -f -p $PASS -u $USER $getSerIP'
sleep 1
count=$((count + 1))
done
}


#=====================
#WAIT FOR NETWORK (I MUST EXAMINE)
#=====================
count=0
#echo -n Waiting for the network...
while [ "$count" -lt 60 ]; 
do
ifconfig eth0 | grep -q inet && break
sleep 1
count=$((count + 1))
echo -n .
done

#===========================================

#echo "Please type 'sh /tmp/menu' in order to get the menu"


getSerIP=192.168.1.111

getLocIP=`ifconfig eth0 | grep 'inet addr:' | cut -d: -f2 | awk '{ print $1}'`
#echo $getLocIP
USER=user01
PASS=123456
VGA="800x600x16"


#=====================
#REMOTE DISPLAY & SCREEN ANALYSIS
#=====================
sudo sed -i -e 's/1024x768x32/'$VGA'/' /home/tc/.xsession
#su - tc -c 'sed -i -e 's/1024x768x32/'$VGA'/' /home/tc/.xsession'
sudo sed -i -e 's/-nolisten/-ac/' /home/tc/.xsession
sudo sed -i -e 's/tcp//' /home/tc/.xsession


#=====================
#EXPORT VARIABLES FOR ATERM
#=====================
export getSerIP=$getSerIP;
export getLocIP=$getLocIP;
export USER=$USER;
export PASS=$PASS;




#wait five sec
count=0
while [ "$count" -lt 5 ]; 
do
sleep 1
count=$((count + 1))
echo -n .
done




 
Conmenu

startx

TYPE=XSR
################################################
case $TYPE in
#=====================================
XSR)
XSRmenu	;;
#=====================================
RDP)
RDPmenu ;;
#=====================================
* )
echo Wrong Connection Type ;;
esac
################################################








